*filter

#Drop all inbound and forward
--policy INPUT DROP
#--policy FORWARD DROP

#Accepts all established inbound connections
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT

#Accepts all established forwarded connections
#-A FORWARD -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

#Allow HTTP
#-A INPUT -p tcp --dport 80 -j ACCEPT
#-A INPUT -p tcp --dport 80  -j ACCEPT

#Allow HTTPS
#-A INPUT -p tcp --dport 443 -j ACCEPT
#-A INPUT -p tcp --dport 443 -j ACCEPT

#Allow SSH
#-A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
#-A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
#-A INPUT -p tcp --dport 22 -d 10.10.10.10 -j ACCEPT
#-A INPUT -p tcp --dport 22 -d 10.10.10.10 -j ACCEPT

#Allow DNS
#-A INPUT -p tcp --dport 53 -d 10.10.10.10 -j ACCEPT
#-A INPUT -p udp --dport 53 -d 10.10.10.10 -j ACCEPT

#Allow IMAP
#-A INPUT -p tcp --dport 143 -d 10.10.10.10 -j ACCEPT
#-A INPUT -p tcp --dport 994 -d 10.10.10.10 -j ACCEPT

#Allow POP3
#-A INPUT -p tcp --dport 110 -d 10.10.10.10 -j ACCEPT
#-A INPUT -p tcp --dport 995 -d 10.10.10.10 -j ACCEPT

# log iptables denied
#-N LOGGING
#-A INPUT -j LOGGING
#-A OUTPUT -j LOGGING
#-A LOGGING -m limit --limit 5/min -j LOG --log-prefix "iptables denied: " --log-level 4
#-A LOGGING -j DROP
#-A INPUT -m limit --limit 5/min -j LOG --log-prefix "iptables denied: " --log-level 7

COMMIT
